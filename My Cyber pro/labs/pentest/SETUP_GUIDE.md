# Advanced Penetration Testing Lab - Setup Guide

## ğŸ¯ What This Lab Provides

This is a **realistic penetration testing environment** that simulates real-world scenarios:

- **1 Attacker Machine** - Ubuntu terminal with professional pentesting tools
- **2 Vulnerable Targets** - DVWA and OWASP Juice Shop
- **Isolated Network** - Safe environment for practicing attacks
- **Web-Based Access** - No local installation needed

## ğŸ—ï¸ Architecture Details

### Network Configuration

```
Docker Network: lab_net (172.20.0.0/16)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Attacker Terminal (172.20.0.10)            â”‚
â”‚  - Ubuntu 22.04                             â”‚
â”‚  - Pentesting tools pre-installed           â”‚
â”‚  - Web terminal on port 7681                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                         â”‚
              â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DVWA (172.20.0.50)  â”‚  â”‚ Juice (172.20.0.60)  â”‚
â”‚  - Port 8081         â”‚  â”‚ - Port 3001          â”‚
â”‚  - PHP/MySQL         â”‚  â”‚ - Node.js/Express    â”‚
â”‚  - Classic vulns     â”‚  â”‚ - Modern vulns       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Container Details

#### 1. Attacker Terminal
- **Container Name:** `pentest_attacker`
- **IP Address:** 172.20.0.10
- **Access:** http://localhost:7681
- **Base Image:** Ubuntu 22.04
- **Tools Installed:**
  - nmap (network scanning)
  - nikto (web scanning)
  - sqlmap (SQL injection)
  - dirb (directory enumeration)
  - hydra (password cracking)
  - metasploit (exploitation)
  - gobuster (brute-forcing)
  - wfuzz (fuzzing)

#### 2. DVWA Target
- **Container Name:** `pentest_dvwa`
- **IP Address:** 172.20.0.50
- **Access:** http://localhost:8081
- **Base Image:** vulnerables/web-dvwa
- **Default Credentials:** admin / password
- **Vulnerabilities:**
  - SQL Injection
  - XSS (Reflected & Stored)
  - CSRF
  - File Upload
  - Command Injection
  - Brute Force

#### 3. OWASP Juice Shop Target
- **Container Name:** `pentest_juice`
- **IP Address:** 172.20.0.60
- **Access:** http://localhost:3001
- **Base Image:** bkimminich/juice-shop
- **Challenges:** 100+ vulnerabilities
- **Vulnerabilities:**
  - Broken Authentication
  - XSS
  - Injection
  - Broken Access Control
  - Security Misconfiguration

## ğŸš€ Step-by-Step Setup

### Method 1: Through CyberPro Portal (Recommended)

1. **Start Portal** (if not running):
   ```powershell
   cd "C:\Users\navin\OneDrive\ë¬¸ì„œ\MY cyber\CyberPro\My Cyber pro"
   npm start
   ```

2. **Access Portal:**
   - Open browser: http://localhost:3000
   - Login: admin / admin123

3. **Launch Lab:**
   - Navigate to **Labs** section
   - Find **Penetration Testing** lab
   - Click **Launch Lab** button
   - Wait 60-90 seconds for all containers to start

4. **Access Services:**
   - Attacker Terminal will auto-open in new tab
   - Or manually access: http://localhost:7681

### Method 2: Direct Docker Compose

1. **Navigate to lab directory:**
   ```powershell
   cd "C:\Users\navin\OneDrive\ë¬¸ì„œ\MY cyber\CyberPro\My Cyber pro\labs\pentest"
   ```

2. **Start all containers:**
   ```powershell
   docker-compose up -d
   ```

3. **Verify containers are running:**
   ```powershell
   docker ps
   ```
   
   You should see:
   - pentest_attacker
   - pentest_dvwa
   - pentest_juice

4. **Access services:**
   - Attacker: http://localhost:7681
   - DVWA: http://localhost:8081
   - Juice Shop: http://localhost:3001

## ğŸ“ First Steps After Launch

### 1. Access Attacker Terminal
Open http://localhost:7681 in your browser. You'll see a welcome screen with available tools.

### 2. Discover Targets
Run the built-in discovery script:
```bash
discover.sh
```

This shows you:
- Target IP addresses
- Available services
- Quick command reference

### 3. Verify Network Connectivity
```bash
# Ping DVWA
ping -c 3 172.20.0.50

# Ping Juice Shop
ping -c 3 172.20.0.60
```

### 4. Perform First Scan
```bash
# Scan DVWA
nmap -sV 172.20.0.50

# Scan Juice Shop
nmap -sV 172.20.0.60
```

## ğŸ¯ Typical Workflow

### Phase 1: Reconnaissance
```bash
# Discover hosts
nmap -sn 172.20.0.0/16

# Identify services
nmap -sV -p- 172.20.0.50
nmap -sV -p- 172.20.0.60
```

### Phase 2: Enumeration
```bash
# Web vulnerability scan
nikto -h http://172.20.0.50

# Directory enumeration
dirb http://172.20.0.50
gobuster dir -u http://172.20.0.60:3000 -w /usr/share/wordlists/dirb/common.txt
```

### Phase 3: Exploitation
```bash
# SQL injection
sqlmap -u "http://172.20.0.50/vulnerabilities/sqli/?id=1&Submit=Submit" \
       --cookie="security=low; PHPSESSID=<session-id>" \
       --dbs

# Password brute-force
hydra -l admin -P /usr/share/wordlists/rockyou.txt \
      172.20.0.50 http-get-form "/login.php:username=^USER^&password=^PASS^:Login failed"
```

## ğŸ”§ Management Commands

### Start Lab
```powershell
cd labs/pentest
docker-compose up -d
```

### Stop Lab
```powershell
docker-compose down
```

### Restart Lab (clean state)
```powershell
docker-compose down
docker-compose up -d
```

### View Logs
```powershell
# All containers
docker-compose logs

# Specific container
docker logs pentest_attacker
docker logs pentest_dvwa
docker logs pentest_juice
```

### Rebuild (after changes)
```powershell
docker-compose build --no-cache
docker-compose up -d
```

## ğŸ› Troubleshooting

### Issue: Containers won't start
**Solution:**
```powershell
# Check Docker is running
docker ps

# Check for port conflicts
netstat -ano | findstr "7681 8081 3001"

# Remove old containers
docker-compose down
docker system prune -f

# Rebuild
docker-compose up -d
```

### Issue: Can't access attacker terminal
**Solution:**
```powershell
# Check if container is running
docker ps | findstr pentest_attacker

# Check container logs
docker logs pentest_attacker

# Restart container
docker restart pentest_attacker
```

### Issue: Targets not reachable from attacker
**Solution:**
```bash
# From attacker terminal, check network
ip addr show

# Verify network configuration
docker network inspect pentest_lab_net

# Restart all containers
docker-compose restart
```

### Issue: DVWA shows database error
**Solution:**
1. Wait 60 seconds after startup (database initialization)
2. Access http://localhost:8081/setup.php
3. Click "Create / Reset Database"
4. Login with admin / password

## ğŸ“Š Expected Resource Usage

- **Disk Space:** ~2-3 GB (all images)
- **RAM:** ~1-2 GB (all containers running)
- **CPU:** Minimal (idle), moderate during scans
- **Network:** Isolated Docker network (no external access)

## ğŸ“ Learning Outcomes

After completing this lab, you will be able to:

âœ… Set up isolated penetration testing environments  
âœ… Perform network reconnaissance and scanning  
âœ… Identify web application vulnerabilities  
âœ… Execute SQL injection attacks  
âœ… Perform directory enumeration  
âœ… Conduct password brute-force attacks  
âœ… Use professional pentesting tools  
âœ… Document findings and write reports  

## ğŸ“š Next Steps

1. Complete all 6 exercises in README.md
2. Try challenges in OWASP Juice Shop
3. Practice writing penetration test reports
4. Explore advanced Metasploit modules
5. Learn about remediation techniques

---

**Happy Ethical Hacking!** ğŸ”
