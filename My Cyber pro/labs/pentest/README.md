# Advanced Penetration Testing Lab

## ğŸ¯ Overview

A **realistic multi-target penetration testing environment** where you practice real-world attack scenarios from an Ubuntu attacker terminal against two vulnerable web applications.

### Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Lab Network (172.20.0.0/16)            â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   Attacker   â”‚â”€â”€â”€â”€â”€â–¶â”‚    DVWA      â”‚               â”‚
â”‚  â”‚  Terminal    â”‚      â”‚ 172.20.0.50  â”‚               â”‚
â”‚  â”‚ 172.20.0.10  â”‚      â”‚  Port 8081   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                                               â”‚
â”‚         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Juice Shop   â”‚               â”‚
â”‚                        â”‚ 172.20.0.60  â”‚               â”‚
â”‚                        â”‚  Port 3000   â”‚               â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Quick Start

### Through Portal
1. Login at http://localhost:3000
2. Go to **Labs** â†’ **Penetration Testing**
3. Click **Launch Lab**
4. Wait 60-90 seconds for all containers to start

### Direct Launch
```powershell
cd labs/pentest
docker-compose up -d
```

### Access Points

| Service | URL | Purpose |
|---------|-----|---------|
| **Attacker Terminal** | http://localhost:7681 | Web-based terminal with pentesting tools |
| **DVWA Target** | http://localhost:8081 | Vulnerable web application |
| **Juice Shop Target** | http://localhost:3001 | Vulnerable e-commerce site |

## ğŸ› ï¸ Lab Components

### 1. Attacker Terminal (172.20.0.10)
**Ubuntu-based terminal with pre-installed tools:**

- **nmap** - Network scanner
- **nikto** - Web vulnerability scanner
- **sqlmap** - SQL injection tool
- **dirb** - Directory brute-forcer
- **hydra** - Password cracker
- **metasploit** - Exploitation framework
- **gobuster** - Directory/DNS enumeration
- **wfuzz** - Web application fuzzer

### 2. Target: DVWA (172.20.0.50)
**Damn Vulnerable Web Application**

- **Port:** 8081 (mapped from 80)
- **Default Login:** admin / password
- **Vulnerabilities:** SQL injection, XSS, CSRF, file upload, command injection
- **Difficulty Levels:** Low, Medium, High, Impossible

### 3. Target: OWASP Juice Shop (172.20.0.60)
**Modern vulnerable e-commerce application**

- **Port:** 3001
- **Vulnerabilities:** 100+ challenges including XSS, injection, broken auth
- **Realistic:** Modern JavaScript application
- **Gamified:** Score tracking and hints

## ğŸ“ Learning Exercises

### Exercise 1: Network Discovery (15 min)

**Objective:** Discover targets on the network

1. Open attacker terminal: http://localhost:7681
2. Run discovery helper:
   ```bash
   discover.sh
   ```
3. Scan the network:
   ```bash
   nmap -sn 172.20.0.0/16
   ```
4. Identify active hosts and their IPs

**Expected Output:** Find 172.20.0.50 (DVWA) and 172.20.0.60 (Juice Shop)

---

### Exercise 2: Port Scanning (20 min)

**Objective:** Identify open ports and services

1. Scan DVWA:
   ```bash
   nmap -sV -p- 172.20.0.50
   ```
2. Scan Juice Shop:
   ```bash
   nmap -sV -p- 172.20.0.60
   ```
3. Identify web servers and versions

**Expected Output:** Port 80 on DVWA, Port 3000 (internal) on Juice Shop

---

### Exercise 3: Web Vulnerability Scanning (25 min)

**Objective:** Scan for web vulnerabilities

1. Scan DVWA with nikto:
   ```bash
   nikto -h http://172.20.0.50
   ```
2. Directory enumeration on DVWA:
   ```bash
   dirb http://172.20.0.50
   ```
3. Scan Juice Shop:
   ```bash
   nikto -h http://172.20.0.60:3000
   ```

**Expected Output:** Identify vulnerable directories and misconfigurations

---

### Exercise 4: SQL Injection Attack (30 min)

**Objective:** Exploit SQL injection in DVWA

1. Access DVWA: http://localhost:8081
2. Login: admin / password
3. Set security to **Low**
4. Go to **SQL Injection** page
5. From attacker terminal, use sqlmap:
   ```bash
   sqlmap -u "http://172.20.0.50/vulnerabilities/sqli/?id=1&Submit=Submit#" \
          --cookie="security=low; PHPSESSID=<your-session-id>" \
          --dbs
   ```

**Expected Output:** Extract database names

---

### Exercise 5: Directory Brute-Forcing (20 min)

**Objective:** Find hidden directories

1. Use gobuster on Juice Shop:
   ```bash
   gobuster dir -u http://172.20.0.60:3000 \
                -w /usr/share/wordlists/dirb/common.txt
   ```
2. Analyze discovered endpoints

**Expected Output:** Find API endpoints and admin panels

---

### Exercise 6: Password Attack (25 min)

**Objective:** Brute-force login credentials

1. Use hydra on DVWA login:
   ```bash
   hydra -l admin -P /usr/share/wordlists/rockyou.txt \
         172.20.0.50 http-get-form \
         "/login.php:username=^USER^&password=^PASS^:Login failed"
   ```

**Expected Output:** Crack weak passwords

---

## ğŸ’¡ Pro Tips

### Finding Target IPs
```bash
# Quick discovery
discover.sh

# Manual discovery
docker inspect pentest_dvwa | grep IPAddress
docker inspect pentest_juice | grep IPAddress
```

### Testing from Host Browser
- DVWA: http://localhost:8081
- Juice Shop: http://localhost:3001

### Testing from Attacker Terminal
- DVWA: http://172.20.0.50
- Juice Shop: http://172.20.0.60:3000

### Common Workflows

**1. Reconnaissance Phase**
```bash
nmap -sn 172.20.0.0/16          # Host discovery
nmap -sV -p- 172.20.0.50        # Service detection
nikto -h http://172.20.0.50     # Web scanning
```

**2. Enumeration Phase**
```bash
dirb http://172.20.0.50         # Directory enumeration
gobuster dir -u http://172.20.0.60:3000 -w /usr/share/wordlists/dirb/common.txt
```

**3. Exploitation Phase**
```bash
sqlmap -u "http://172.20.0.50/..." --dbs
hydra -l admin -P wordlist.txt 172.20.0.50 http-post-form
```

## âš ï¸ Important Notes

### Legal & Ethical
- **Educational Use Only** - Never attack systems you don't own
- **Legal Implications** - Unauthorized testing is illegal
- **Ethics First** - Always get written permission
- **Responsible Disclosure** - Report vulnerabilities properly

### Lab Safety
- Targets are isolated in Docker network
- No external network access from targets
- Safe to practice without risk
- Reset anytime with `docker-compose down && docker-compose up -d`

## ğŸ› Troubleshooting

### Containers won't start
```powershell
# Check Docker is running
docker ps

# Rebuild containers
cd labs/pentest
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### Can't access targets from attacker terminal
```bash
# Check network connectivity
ping 172.20.0.50
ping 172.20.0.60

# Verify containers are on same network
docker network inspect pentest_lab_net
```

### DVWA shows error
```bash
# DVWA needs time to initialize database
# Wait 60 seconds after startup
# Then access http://localhost:8081/setup.php
```

### Tools not found
```bash
# Verify tools are installed
which nmap
which nikto
which sqlmap

# Reinstall if needed (from attacker terminal)
apt-get update && apt-get install -y nmap nikto sqlmap
```

## ğŸ“– Additional Resources

- [DVWA Documentation](https://github.com/digininja/DVWA)
- [OWASP Juice Shop](https://owasp.org/www-project-juice-shop/)
- [nmap Reference](https://nmap.org/book/man.html)
- [Metasploit Unleashed](https://www.metasploitunleashed.com/)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)

## ğŸ¯ Learning Path

**Recommended Order:**
1. âœ… Exercise 1: Network Discovery
2. âœ… Exercise 2: Port Scanning
3. âœ… Exercise 3: Web Vulnerability Scanning
4. âœ… Exercise 4: SQL Injection Attack
5. âœ… Exercise 5: Directory Brute-Forcing
6. âœ… Exercise 6: Password Attack

**Time Required:** ~2.5 hours total

---

**Practice ethical hacking responsibly!** ğŸ”
