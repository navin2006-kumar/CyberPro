@echo off
echo ========================================
echo   Rebuilding Attacker Container
echo   (Fixes the blinking terminal issue)
echo ========================================
echo.

cd /d "%~dp0"

echo [1/3] Stopping attacker container...
docker-compose stop attacker

echo.
echo [2/3] Rebuilding attacker with fix...
echo This will take 2-3 minutes...
docker-compose build --no-cache attacker

if %errorlevel% neq 0 (
    echo [ERROR] Build failed
    pause
    exit /b 1
)

echo.
echo [3/3] Starting attacker container...
docker-compose up -d attacker

if %errorlevel% neq 0 (
    echo [ERROR] Failed to start
    pause
    exit /b 1
)

echo.
echo ========================================
echo   Fix Applied Successfully!
echo ========================================
echo.
echo The attacker terminal should now work properly.
echo Access it at: http://localhost:7681
echo.
echo The terminal will display a welcome message and stay running.
echo.
pause
